<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="/favicon.jpg" type="image/jpeg" sizes="120x120">
  <title>Study Planner</title>

  <style>
    /* ===== Base theme (coerente col tuo styles.css) ===== */
    :root{
      --bg0:#070a12;
      --bg1:#0b0f1a;

      --text: rgba(255,255,255,.93);
      --muted: rgba(255,255,255,.66);

      --border: rgba(255,255,255,.12);
      --border2: rgba(255,255,255,.18);

      --panel: rgba(255,255,255,.07);
      --shadow: 0 18px 60px rgba(0,0,0,.50);

      --r: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(99,102,241,.16), transparent 58%),
        radial-gradient(900px 600px at 80% 15%, rgba(34,197,94,.08), transparent 58%),
        radial-gradient(900px 700px at 50% 95%, rgba(245,158,11,.06), transparent 62%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }

    a{ color:inherit; text-decoration:none; }
    h1,h2,h3,p{ margin:0; }
    .hidden{ display:none !important; }

    /* ===== Layout ===== */
    .container{
      max-width: 560px;
      margin: 0 auto;
      padding: 28px 16px 56px;
    }

    .header{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-bottom: 14px;
    }

    .header h1{
      font-size: 30px;
      letter-spacing:-.02em;
    }

    .muted{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }

    /* ===== Card ===== */
    .card{
      position: relative;
      isolation: isolate;
      overflow: hidden;

      border: 1px solid var(--border);
      border-radius: var(--r);
      background: var(--panel);
      box-shadow: var(--shadow);
      padding: 14px;

      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .card::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.10));
      pointer-events:none;
      z-index:0;
    }
    .card > *{ position:relative; z-index:1; }

    /* ===== Tabs ===== */
    .tabs{ display:flex; gap:8px; margin-bottom:10px; }
    .tab{
      flex:1;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      cursor:pointer;
      font: inherit;
    }
    .tab.active{
      background: rgba(255,255,255,.12);
      color: var(--text);
    }

    /* ===== Forms ===== */
    .form{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top: 12px;
    }

    label{ font-size:12px; color: var(--muted); }

    input,select{
      width:100%;
      padding:12px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      color-scheme: dark;
      -webkit-text-fill-color: rgba(255,255,255,.92);
    }
    input:focus,select:focus{
      border-color: rgba(255,255,255,.22);
      box-shadow: 0 0 0 4px rgba(255,255,255,.08);
    }

    .error{
      min-height:18px;
      color: rgba(251,113,133,.95);
      font-size:12px;
      margin: 0;
    }

    /* ===== Buttons ===== */
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;

      padding:10px 12px;
      border-radius: 12px;

      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--text);

      cursor:pointer;
      user-select:none;
      transition: transform .05s ease, filter .15s ease, background .15s ease;
      font: inherit;
    }
    .btn:hover{ filter: brightness(1.08); }
    .btn:active{ transform: translateY(1px); }

    .btn.primary{
      background: rgba(255,255,255,.92);
      color:#0b0f1a;
      border-color: transparent;
      font-weight: 900;
    }

    /* ===== Password toggle ===== */
    .pwWrap{
      position: relative;
      display:flex;
      align-items:center;
    }
    .pwWrap input{ padding-right: 44px; }

    .pwToggle{
      position:absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);

      width: 34px;
      height: 34px;
      border-radius: 12px;

      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.78);

      cursor:pointer;
      display:grid;
      place-items:center;

      transition: filter .15s ease, transform .05s ease, background .15s ease;
    }
    .pwToggle:hover{ filter: brightness(1.08); }
    .pwToggle:active{ transform: translateY(-50%) translateY(1px); }

    /* ===== Toast (coerente col tuo stile) ===== */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      z-index: 9999;
      width: min(560px, calc(100% - 24px));
    }
    .toast.hidden { display: none; }
    .toastInner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 14px;
      border-radius: 14px;
      background: rgba(17, 24, 39, 0.92);
      color: #fff;
      box-shadow: 0 10px 30px rgba(0,0,0,.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.12);
    }
    .toastMsg {
      font-size: 14px;
      line-height: 1.25;
    }
    .toastClose {
      border: 0;
      background: rgba(255,255,255,0.12);
      color: #fff;
      width: 32px;
      height: 32px;
      border-radius: 10px;
      cursor: pointer;
    }
    .toastClose:hover { background: rgba(255,255,255,0.18); }
  </style>
</head>

<body>
  <div class="container">
    <header class="header">
      <h1>Study Planner</h1>
      <p class="muted">Accedi per costruire un piano settimanale realistico.</p>
    </header>

    <main class="card">
      <div class="tabs">
        <button class="tab active" id="tab-login" type="button">Login</button>
        <button class="tab" id="tab-signup" type="button">Crea account</button>
      </div>

      <form id="login-form" class="form">
        <label>Email</label>
        <input type="email" id="login-email" required placeholder="nome@uni.it" autocomplete="email" />

        <label>Password</label>
        <div class="pwWrap">
          <input type="password" id="login-pass" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
          <button type="button" class="pwToggle" aria-label="Mostra password" title="Mostra/Nascondi">âŒ£</button>
        </div>

        <button type="submit" class="btn primary" id="login-submit">Entra</button>
        <p class="error" id="login-error"></p>
      </form>

      <form id="signup-form" class="form hidden">
        <label>Email</label>
        <input type="email" id="signup-email" required placeholder="nome@uni.it" autocomplete="email" />

        <label>Password</label>
        <div class="pwWrap">
          <input type="password" id="signup-pass" required placeholder="min 6 caratteri" autocomplete="new-password" />
          <button type="button" class="pwToggle" aria-label="Mostra password" title="Mostra/Nascondi">âŒ£</button>
        </div>

        <button type="submit" class="btn primary" id="signup-submit">Crea account</button>
        <p class="error" id="signup-error"></p>
      </form>
    </main>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden" role="status" aria-live="polite">
    <div class="toastInner">
      <div id="toast-msg" class="toastMsg">â€”</div>
      <button id="toast-close" class="toastClose" type="button" aria-label="Chiudi">âœ•</button>
    </div>
  </div>

  <script type="module">
    // ========= UI helpers =========
    const $ = (id) => document.getElementById(id);

    // Tabs
    const tabLogin = $("tab-login");
    const tabSignup = $("tab-signup");
    const loginForm = $("login-form");
    const signupForm = $("signup-form");

    function setTab(which){
      const isLogin = which === "login";
      tabLogin.classList.toggle("active", isLogin);
      tabSignup.classList.toggle("active", !isLogin);
      loginForm.classList.toggle("hidden", !isLogin);
      signupForm.classList.toggle("hidden", isLogin);

      // pulizia errori
      $("login-error").textContent = "";
      $("signup-error").textContent = "";
    }

    tabLogin.addEventListener("click", () => setTab("login"));
    tabSignup.addEventListener("click", () => setTab("signup"));

    // Password visibility toggles
    document.querySelectorAll(".pwToggle").forEach((btn) => {
      btn.addEventListener("click", () => {
        const input = btn.parentElement.querySelector("input");
        const show = input.type === "password";
        input.type = show ? "text" : "password";
        btn.textContent = show ? "âŒ£" : "ð“¹";
        btn.setAttribute("aria-label", show ? "Nascondi password" : "Mostra password");
      });
    });

    // Toast
    const toast = $("toast");
    const toastMsg = $("toast-msg");
    const toastClose = $("toast-close");
    let toastTimer = null;

    function showToast(msg, ms=2600){
      toastMsg.textContent = msg;
      toast.classList.remove("hidden");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.add("hidden"), ms);
    }
    toastClose.addEventListener("click", () => toast.classList.add("hidden"));

    // ========= Auth integration =========
    // Qui importi il tuo app.js esistente (firebase/auth). Mantieni la logica lÃ¬.
    // In questo index.html gestiamo solo UI (tabs, eye toggle, toast).
    import "./app.js";

    // Opzionale: se nel tuo app.js lanci eventi custom, puoi ascoltarli qui.
    // Esempio: window.dispatchEvent(new CustomEvent("toast", { detail: "Email inviata" }))
    window.addEventListener("toast", (e) => showToast(String(e.detail || "â€”")));

    // Debug UX: evita doppio submit in caso di Enter ripetuti
    $("login-form").addEventListener("submit", () => showToast("Accesso in corsoâ€¦", 1600));
    $("signup-form").addEventListener("submit", () => showToast("Creazione accountâ€¦", 1600));
  </script>
</body>
</html>
